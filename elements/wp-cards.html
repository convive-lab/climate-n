<!--
author:Aaron
description: fetch a wp-post by its id
properties: post:<post-number>
-->
<link rel="import" href="../bower_components/polymer/polymer.html">
<dom-module id="wp-cards">
    <style>
        :host {
        }
    </style>
    <template>
        <iron-localstorage name="lang" value={{lg}}  iron-localstorage-load="_langchange"></iron-localstorage>
        <iron-localstorage name="wp[[post]]" value="{{ajaxResponse}}"></iron-localstorage>
        <template is="dom-if" if={{!ajaxResponse}}>
          <iron-ajax id="wp-data" auto url="http://cn.convive.io/wp-json/wp/v2/posts/[[post]]" handle-as="json" last-response="{{ajaxResponse}}" on-response="_langchange"></iron-ajax>
        </template>
        <paper-material elevation="0">
        <template is="dom-if" if=[[wptitel]]><h1><html-echo html="[[title]]"></html-echo> </h1></template>
          <div class="card-content">
            <html-echo html="[[text]]"></html-echo>
          </div>
        </paper-material>
    </template>
</dom-module>

<script>
    Polymer({
        is: "wp-cards",
       properties:{
          post:{
            type:String
          },
          wptitel:false,
          title:{
            type:String
          },
          text:{
            type:String
          },
          ajaxResponse:{
            type:Object
          }
          ,
          lg:{
            type:String,
            observer:'_langchange',
            notify: true,
            value:"la"

        },

    },
         _langchange:function (newVal, oldVal) {
        if(typeof this.ajaxResponse != "undefined"){
          console.log(this.oldVal);
          if (this.lg=="de_DE"){
            this.title = this.ajaxResponse.title.rendered;
            this.text = this.ajaxResponse.content.rendered;
          }
          else if (this.lg=="fr_FR"){
            this.title = this.ajaxResponse.acf.fr_FR_title;
            this.text = this.ajaxResponse.acf.fr_FR_text;
          }

          else if (this.lg=="es_ES"){
             this.title = this.ajaxResponse.acf.es_ES_title;
             this.text = this.ajaxResponse.acf.es_ES_text;
           }
          else{
            this.title = this.ajaxResponse.acf.en_EN_title;
            this.text = this.ajaxResponse.acf.en_EN_text;
          }
        }
        }
      });
</script>
