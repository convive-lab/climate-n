<dom-module id="calculator-el">
  <style type="text/css">
          :host {
            width: 50%;
            @apply(--paper-card);
        }
        .horizontal{
            @apply(--layout-horizontal);
            @apply(--layout-wrap);
            @apply(--layout-center-justified);
            @apply(--layout-center);
        }
        #btnnext{
             @apply(--layout-end-justified);
        }
        #btnback{
             @apply(--layout-start-justified);
        }
        .vertical{
            @apply(--layout-vertical);
            @apply(--layout-center-justified);
        }
        span { font-weight: bold; }
        .co2Value{
            font-size: 150%;
        }

  </style>
  <template >
    <div class="container horizontal">
        <paper-card class=" horizontal" elevation="1" animated-shadow="false">

        <div class="left">
            <template is="dom-if" if={{!questionsResponse}}>
                <iron-ajax id="menu-data" auto url="http://cn.convive.io/wp-json/wp/v2/posts/?filter[cat]=3" handle-as="json" last-response="{{questionsResponse}}" ></iron-ajax>
            </template>
            <iron-localstorage name="questions" value="{{questionsResponse}}"></iron-localstorage>
            <iron-pages selected="0">
                <selection>
                    <h1>Los Geht's</h1>
                    <paper-button id="btnnext" class="right" on-click="_addEventListn">weiter</paper-button>
                </selection>
                <template is="dom-repeat" items="{{questionsResponse}}">
                    <section> 
                        <cal-question data="[[item]]">
                            <div class="container buttons">
                                <paper-button id="btnback">zurück</paper-button>
                                <paper-button id="btnnext" class="right">weiter</paper-button>

                            </div>
                        </cal-question>
                    </section>
                </template>
                <selection>
                    <h1>Dankeschön</h1>
                    <paper-button id="btnback">zurück</paper-button>
                    <paper-button id="btnfin" class="right">finished</paper-button>
                </selection>
            </iron-pages>
 
            
        </div>

            <div class="right vertical">
                
                <paper-card elevation="0" heading="Deine CO2 Emissionen" image="" elevation="1" animated-shadow="false">
                  <div class="card-content test vertical">
                  <paper-material elevation="1">
                       <div class="co2Value"><span>{{finalValue}}</span> t C02/Jahr</div>
                  </paper-material>
                 
                <iron-image src="../data/fever.png" class=".vertical" ></iron-image>
                </paper-card>

            </div>
                      <div class="card-content"></div>
        </paper-card>
    </div>
        
  </template>
  <script>
    Polymer({
        is: 'calculator-el',
        properties: {

            position:1,
            q1:{type:Number,Value:0},
            q2:{type:Number,Value:0},
            q3:{type:Number,Value:0},
            q4:{type:Number,Value:0},
            q5:{type:Number,Value:0},
            q6:{type:Number,Value:0},
            q7:{type:Number,Value:0},
            q8:{type:Number,Value:0},
            q8:{type:Number,Value:0},
            q10:{type:Number,Value:0},
            finalValue:{type:Number,Value:0}    
        },
        _hresponse: function (request) {
            this.empty=false;
           localStorage.setItem("questions",JSON.stringify(request.detail.response));
        },
        questionsResponse:{
            type:Object        
        },
        srchandler:function (){
            var cal = document.querySelector('calculator-el');

        },
        getValues(){
            var cal = document.querySelector('calculator-el');
            var quest = document.querySelectorAll('cal-question');
            cal.q1=parseInt(quest[0].co2);
            cal.q2=parseInt(quest[1].co2);
            cal.q3=parseInt(quest[2].co2);
            cal.q4=parseInt(quest[3].co2);
            // cal.q5=parseInt(quest[1].co2);
            // cal.q6=parseInt(quest[1].co2);
            // cal.q7=parseInt(quest[1].co2);
            // cal.q8=parseInt(quest[1].co2);
            // cal.q9=parseInt(quest[1].co2);
            // cal.q10=parseInt(quest[1].co2);

             // body...  
        },
        calFinalValue:function (){
            var cal = document.querySelector('calculator-el');
           cal.finalValue= parseInt(cal.q1)+parseInt(cal.q2)+parseInt(cal.q3)+parseInt(cal.q4)+parseInt(cal.q5)+parseInt(cal.q6)+parseInt(cal.q7)+parseInt(cal.q8)+parseInt(cal.q8)+parseInt(cal.q10);
        },
        evented:false,
        _addEventListn:function () {
            if (!this.evented){
                console.log('here I am ');
                var cal = document.querySelector('calculator-el');
                var next =document.querySelectorAll('#btnnext'); 
                var pages = document.querySelector('iron-pages');
                cal.evented=true;
                pages.selectNext();
                for (i = 0; i < next.length; ++i) {
                    next[i].addEventListener('click', function(e) {
                            console.log();
                            //check if answer else ale rt
                            pages.selectNext();
                            cal.getValues ();
                            cal.calFinalValue();
                            
                    });
                }
                var back =document.querySelectorAll('#btnback');
                for (i = 0; i < next.length; ++i) {
                    back[i].addEventListener('click', function(e) {
                            var pages = document.querySelector('iron-pages');
                            pages.selectPrevious();
                            cal.getValues ();
                            cal.calFinalValue();
                    });
                }
            }
        },
        ready:function (){
            localStorage.clear();
            var cal = document.querySelector('calculator-el');
            cal.finalValue=0;
            cal.q1=0;
            cal.q2=0;
            cal.q3=0;
            cal.q4=0;
            cal.q5=0;
            cal.q6=0;
            cal.q7=0;
            cal.q8=0;
            cal.q8=0;
            cal.q10=0;
        }


    });
  </script>
</dom-module>